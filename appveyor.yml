version: 0.1.{build}

environment:
  matrix:
    - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2019
      PowerShellEdition: PowerShellCore

skip_commits:
  message: /updated readme.*|update readme.*s/
  files:
    - .github/
    - .vscode/
    - assets/
    - README.md
    - .gitattributes
    - .gitignore

install:
    - pwsh: if ($env:PowerShellEdition -eq 'PowerShellCore')    { . .\build.ps1 -Bootstrap }

build: off

# Kick off the CI/CD pipeline
test_script:
  - pwsh: if ($env:PowerShellEdition -eq 'PowerShellCore')    { . .\build.ps1 -Task Test }

deploy:
    provider: GitHub
    release: v$(appveyor_build_version)
    description: ''
    auth_token:
        secure: TIE6vf/OAY070tpQEUC4Uv8DP8TxWf/MKMEzIew4zFlNyUsnK7IGT/PhPpg2zkuG
    draft: false
    prerelease: false
    on:
        branch: master                  # release from master branch only
        appveyor_repo_tag: false
